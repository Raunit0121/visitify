# Visitify Web Visitor Check-in

A web-based QR code scanner for visitor registration that integrates with the Visitify Flutter app.

## Features

- **QR Code Scanning**: Camera-based QR code scanning using HTML5
- **Real-time Validation**: Validates QR invitations against Firebase
- **Visitor Registration**: Collects visitor information and photos
- **Instant Notifications**: Notifies both guards and residents in real-time
- **Responsive Design**: Works on desktop, tablet, and mobile devices
- **Offline Handling**: Graceful error handling for network issues

## Setup Instructions

### 1. Firebase Configuration

1. Copy your Firebase configuration from the Flutter app
2. Update `firebase-config.js` with your actual Firebase config:

```javascript
const firebaseConfig = {
    apiKey: "your-actual-api-key",
    authDomain: "your-project.firebaseapp.com",
    projectId: "your-actual-project-id",
    storageBucket: "your-project.appspot.com",
    messagingSenderId: "123456789",
    appId: "your-actual-app-id"
};
```

### 2. Firestore Security Rules

Add these rules to your Firestore to allow web access:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Allow read access to QR invitations for validation
    match /qr_invitations/{invitationId} {
      allow read: if true;
      allow update: if true; // For incrementing used_count
    }
    
    // Allow write access to visitors collection
    match /visitors/{visitorId} {
      allow create: if true;
      allow read: if true;
    }
    
    // Allow write access to notifications
    match /notifications/{notificationId} {
      allow create: if true;
    }
  }
}
```

### 3. Web Hosting

#### Option A: Firebase Hosting (Recommended)

1. Install Firebase CLI:
```bash
npm install -g firebase-tools
```

2. Initialize Firebase hosting in the web directory:
```bash
cd web
firebase init hosting
```

3. Deploy:
```bash
firebase deploy --only hosting
```

#### Option B: Static Web Server

1. Serve the web directory using any static web server:
```bash
# Using Python
python -m http.server 8000

# Using Node.js http-server
npx http-server

# Using PHP
php -S localhost:8000
```

### 4. HTTPS Requirement

**Important**: The web app requires HTTPS to access the camera for QR scanning. Make sure your hosting solution provides HTTPS.

## File Structure

```
web/
├── index.html          # Main HTML file
├── styles.css          # CSS styles
├── app.js             # Main JavaScript application
├── firebase-config.js  # Firebase configuration
└── README.md          # This file
```

## How It Works

### User Flow

1. **Welcome Screen**: Visitor sees instructions and starts QR scanning
2. **QR Scanner**: Camera opens to scan the QR code from resident
3. **Validation**: QR code is validated against Firebase database
4. **Registration**: Visitor fills in their details (name, phone, etc.)
5. **Notifications**: System notifies both guard and resident
6. **Success**: Confirmation screen with registration details

### Technical Flow

1. **QR Parsing**: Extracts invitation ID from scanned QR code
2. **Firebase Query**: Validates invitation in Firestore
3. **Usage Tracking**: Increments invitation usage count
4. **Visitor Creation**: Saves visitor record to database
5. **Notification Dispatch**: Sends real-time notifications

## Integration with Flutter App

The web app integrates seamlessly with the Flutter app:

- **Shared Database**: Uses the same Firestore collections
- **QR Format**: Compatible with QR codes generated by Flutter app
- **Notifications**: Sends notifications that appear in Flutter app
- **Data Structure**: Uses identical data models

## Browser Compatibility

- **Chrome**: Full support
- **Firefox**: Full support
- **Safari**: Full support (iOS 11+)
- **Edge**: Full support

## Troubleshooting

### Camera Access Issues

1. Ensure the site is served over HTTPS
2. Check browser permissions for camera access
3. Try refreshing the page or restarting the browser

### QR Code Not Scanning

1. Ensure good lighting conditions
2. Hold the QR code steady within the frame
3. Try different distances from the camera

### Firebase Connection Issues

1. Check Firebase configuration in `firebase-config.js`
2. Verify Firestore security rules
3. Check browser console for error messages

## Customization

### Styling

Modify `styles.css` to match your branding:
- Colors: Update CSS custom properties
- Logo: Replace the header content
- Layout: Adjust responsive breakpoints

### Functionality

Extend `app.js` to add features:
- Additional form fields
- Photo upload to Firebase Storage
- SMS notifications
- Integration with access control systems

## Security Considerations

1. **Firestore Rules**: Implement proper security rules for production
2. **Input Validation**: Validate all user inputs on both client and server
3. **Rate Limiting**: Consider implementing rate limiting for API calls
4. **HTTPS Only**: Always serve over HTTPS in production

## Performance Optimization

1. **Image Compression**: Compress visitor photos before upload
2. **Caching**: Implement service worker for offline functionality
3. **Lazy Loading**: Load resources only when needed
4. **Minification**: Minify CSS and JavaScript for production

## Support

For issues or questions:
1. Check the browser console for error messages
2. Verify Firebase configuration and rules
3. Test with different browsers and devices
4. Check network connectivity